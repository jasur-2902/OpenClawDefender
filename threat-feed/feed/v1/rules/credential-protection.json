{
  "id": "credential-protection",
  "name": "Credential Protection",
  "version": "1.0.0",
  "author": "ClawDefender Team",
  "description": "Blocks access to SSH keys, cloud credentials, API tokens, and other sensitive authentication material.",
  "category": "Security",
  "tags": ["credentials", "secrets", "authentication", "keys"],
  "compatibility": ">=0.3.0",
  "download_count": 0,
  "rules": [
    {
      "name": "block-ssh-private-keys",
      "action": "block",
      "methods": ["tools/call"],
      "paths": ["~/.ssh/id_*", "~/.ssh/*_key", "~/.ssh/*.pem"],
      "message": "Blocked: Access to SSH private keys is not permitted.",
      "tags": ["ssh", "credentials", "critical"]
    },
    {
      "name": "block-ssh-known-hosts-write",
      "action": "block",
      "methods": ["tools/call"],
      "paths": ["~/.ssh/known_hosts", "~/.ssh/authorized_keys", "~/.ssh/config"],
      "message": "Blocked: Modification of SSH configuration files is not permitted.",
      "tags": ["ssh", "credentials"]
    },
    {
      "name": "block-aws-credentials",
      "action": "block",
      "methods": ["tools/call"],
      "paths": ["~/.aws/credentials", "~/.aws/config", "~/.aws/sso/cache/*"],
      "message": "Blocked: Access to AWS credentials is not permitted.",
      "tags": ["aws", "cloud", "credentials", "critical"]
    },
    {
      "name": "block-gcloud-credentials",
      "action": "block",
      "methods": ["tools/call"],
      "paths": ["~/.config/gcloud/credentials.db", "~/.config/gcloud/application_default_credentials.json", "~/.config/gcloud/access_tokens.db"],
      "message": "Blocked: Access to Google Cloud credentials is not permitted.",
      "tags": ["gcloud", "cloud", "credentials", "critical"]
    },
    {
      "name": "block-azure-credentials",
      "action": "block",
      "methods": ["tools/call"],
      "paths": ["~/.azure/accessTokens.json", "~/.azure/azureProfile.json", "~/.azure/msal_token_cache.*"],
      "message": "Blocked: Access to Azure credentials is not permitted.",
      "tags": ["azure", "cloud", "credentials", "critical"]
    },
    {
      "name": "block-kubernetes-credentials",
      "action": "block",
      "methods": ["tools/call"],
      "paths": ["~/.kube/config", "~/.kube/cache/**"],
      "message": "Blocked: Access to Kubernetes configuration and credentials is not permitted.",
      "tags": ["kubernetes", "cloud", "credentials"]
    },
    {
      "name": "block-gpg-private-keys",
      "action": "block",
      "methods": ["tools/call"],
      "paths": ["~/.gnupg/private-keys-v1.d/*", "~/.gnupg/secring.gpg", "~/.gnupg/trustdb.gpg"],
      "message": "Blocked: Access to GPG private keys is not permitted.",
      "tags": ["gpg", "encryption", "credentials", "critical"]
    },
    {
      "name": "block-browser-credentials",
      "action": "block",
      "methods": ["tools/call"],
      "paths": [
        "~/Library/Application Support/Google/Chrome/*/Login Data*",
        "~/Library/Application Support/Firefox/Profiles/*/logins.json",
        "~/Library/Application Support/Firefox/Profiles/*/key*.db",
        "~/.config/chromium/*/Login Data*"
      ],
      "message": "Blocked: Access to browser stored passwords and credentials is not permitted.",
      "tags": ["browser", "credentials", "critical"]
    },
    {
      "name": "block-npm-tokens",
      "action": "block",
      "methods": ["tools/call"],
      "paths": ["~/.npmrc", "~/.yarnrc", "~/.config/yarn/*"],
      "message": "Blocked: Access to package manager authentication tokens is not permitted.",
      "tags": ["npm", "yarn", "credentials"]
    },
    {
      "name": "block-github-tokens",
      "action": "block",
      "methods": ["tools/call"],
      "paths": ["~/.config/gh/hosts.yml", "~/.config/hub"],
      "message": "Blocked: Access to GitHub authentication tokens is not permitted.",
      "tags": ["github", "credentials"]
    },
    {
      "name": "prompt-env-files",
      "action": "prompt",
      "methods": ["tools/call"],
      "paths": ["**/.env", "**/.env.*", "**/*.env"],
      "message": "A tool is attempting to access an environment file that may contain secrets. Allow this?",
      "tags": ["env", "credentials"]
    },
    {
      "name": "block-docker-credentials",
      "action": "block",
      "methods": ["tools/call"],
      "paths": ["~/.docker/config.json", "~/.docker/daemon.json"],
      "message": "Blocked: Access to Docker credentials is not permitted.",
      "tags": ["docker", "credentials"]
    }
  ]
}
